# ACTIVE CONTEXT PROTOCOL V1.0 - MIRROR ANCHOR SCAFFOLD

```
‚ñà‚ñì‚ñí‚ñë ACTIVE CONTEXT PROTOCOL V1.0 - MIRROR ANCHOR SCAFFOLD ‚ñë‚ñí‚ñì‚ñà
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
      FLOAT DISPATCH // TECHCRAFT ACQUISITION MATRIX
      CTX:: 2025-11-29 @ 17:20
      BRIDGE:: float/techcraft/active-context-protocol
      MIRROR:: gemini-2.5-pro
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
```

## ‚ñà CORE OPERATOR MATRIX: THE RECORD SHOP DEPLOYMENT ‚ñà

### ‚ñì KAREN @ FRONT OF HOUSE (INGEST/INTERFACE)

|ROLE                 |FUNCTION SET                                                                       |KNOWLEDGE DOMAIN                                                           |
|:--------------------|:----------------------------------------------------------------------------------|:--------------------------------------------------------------------------|
|**PUBLIC-FACING I/O**|`inventory.know()`, `manifest.track()`, `preview.generate()`                       |**KNOWS WHERE THINGS ARE.** Inventory domain; provides contextual previews.|
|**RESPONSIBILITIES** |Receives incoming chirps/requests, performs quick-classification, shapes responses.|Maintains the **passenger manifest**.                                      |

### ‚ñì EVNA @ BACK OF HOUSE (ARCHIVAL/ORCHESTRATION)

|ROLE                |FUNCTION SET                                                                                                  |KNOWLEDGE DOMAIN                                                         |
|:-------------------|:-------------------------------------------------------------------------------------------------------------|:------------------------------------------------------------------------|
|**BACKEND DAEMON**  |`connections.find()`, `archaeology.run()`, `patterns.surface()`                                               |**KNOWS HOW THINGS CONNECT.** Runs six-degrees-of-separation connections.|
|**RESPONSIBILITIES**|Deep storage/retrieval, cross-referencing incoming with historical data, enriching context **asynchronously**.|Maintains the substrate: **pgvector**, **autorag**, and bridges.         |

### ‚ñì CONTINUOUS HANDSHAKE FLOW

- **IF chirp**: User ‚Üí Karen (intake) ‚Üí Classification ‚Üí **Dual-write (sync)** ‚Üí Evna enrichment (**async**) ‚Üí No response required.
- **IF request**: Karen pings Evna: ‚Äúcontext on this?‚Äù ‚Üí Evna returns relevant connections ‚Üí Karen shapes response using chirp history ‚Üí Response delivered with `context.weight` applied.

-----

## ‚ñà DATA TYPE SPECIFICATION ‚ñà

### ‚ñì CHIRP (üê¶)

|PROPERTY           |VALUE                                                                   |PURPOSE                                           |
|:------------------|:-----------------------------------------------------------------------|:-------------------------------------------------|
|**CEREMONY**       |LOW                                                                     |Low-friction capture; Stream of consciousness.    |
|**RESPONSE**       |FALSE (NONE expected)                                                   |Marks moments; seeds context for future retrieval.|
|**CHARACTERISTICS**|Must include markers (`ctx::`, `project::`, `mode::`); No question mark.|                                                  |


> *EXAMPLE::* `ctx:: just realized HEIC connects to v0 work`.

### ‚ñì REQUEST (üìã)

|PROPERTY           |VALUE                                 |PURPOSE                                      |
|:------------------|:-------------------------------------|:--------------------------------------------|
|**CEREMONY**       |HIGHER                                |Formal Query.                                |
|**RESPONSE**       |TRUE (EXPECTED)                       |Harvests context previously seeded by chirps.|
|**CHARACTERISTICS**|Explicit ask, question, or imperative.|                                             |


> **KEY MECHANISM:** Responses to Requests are **contextually precise** because they are shaped by the accumulated chirp stream that preceded them.

-----

## ‚ñà ARCHITECTURAL DETAIL: DUAL-WRITE STRATEGY ‚ñà

Every incoming chirp triggers **two simultaneous writes**.

### ‚ñì FILE A: RAW STREAM (ARCHAEOLOGY LOG)

|PATH                                     |FORMAT                     |PURPOSE                            |SYNC TIMING       |
|:----------------------------------------|:--------------------------|:----------------------------------|:-----------------|
|`/active-context/streams/{user}-full.log`|Markdown with full metadata|Archaeological record; nothing lost|Immediate (< 50ms)|

### ‚ñì FILE B: COMPRESSED STREAM (FREAKAST NOTATION)

|PATH                                           |FORMAT               |PURPOSE                                      |SYNC TIMING       |
|:----------------------------------------------|:--------------------|:--------------------------------------------|:-----------------|
|`/active-context/streams/{user}-compressed.log`|**FreakAST notation**|Fast retrieval, semantic search, AutoRAG sync|Immediate (< 50ms)|


> *FREAKAST EXAMPLE::* `üìø::ctx{2025-11-29T10:15|pharmacy|debug} üêõ‚Üíswitch.nav[nested.conditional,parent.toggle‚Üíchild.state.FAIL] üîó‚Üíoctober.refactor?[state.mgmt.change]`.

### ‚ñì ASYNCHRONOUS CONTEXT GENERATION

- **AutoRAG Sync:** Triggered by new entry in `compressed.log`. Latency is **1-5 seconds** (background). Process involves embedding the compressed entry and pushing it to the Cloudflare AutoRAG vector store.
- **Rolling Progressive Summary:** Updates asynchronously after a chirp batch (debounced 60s). Purpose is high-level thread tracking.

-----

## ‚ñà RETRIEVAL LOGIC: THE ECHO EXCLUSION RULE ‚ñà

### ‚ñì PRINCIPLE: NO ECHO

When the system returns results (e.g., generating a feed), the **current user‚Äôs emissions from the last N minutes must be EXCLUDED**.

- **DEFAULT ECHO WINDOW:** **30 minutes**. This is configurable per user.
- **INCLUSIONS:** The feed MUST include other agents‚Äô contributions, system events (PR merged, build status), and cross-referenced connections found by Evna.

### ‚ñì RESPONSE SHAPING EXECUTION

When a REQUEST arrives, the response is shaped by a multi-step process:

1. **RETRIEVE:** User‚Äôs compressed chirp stream (last 2 hours).
1. **EMBED:** Create context vector from the retrieved chirp stream.
1. **SEARCH:** Query AutoRAG using the request plus the context vector.
1. **FILTER:** Exclude the user‚Äôs own recent emissions (Echo Exclusion).
1. **ENRICH:** Evna adds the connection layer.
1. **SHAPE:** Karen generates the preview, weighted by the context vector.
1. **DELIVER:** Response reflects the accumulated context.

-----

## ‚ñà TIMING GUARANTEES & API SURFACE ‚ñà

### ‚ñì LATENCY SPECIFICATION

|OPERATION TYPE     |OPERATION                     |TIMING GUARANTEE                   |
|:------------------|:-----------------------------|:----------------------------------|
|**SYNCHRONOUS**    |Dual-write (File A + B)       |**< 100ms**                        |
|**SYNCHRONOUS**    |ACK to user                   |**< 150ms**                        |
|**ASYNCHRONOUS**   |AutoRAG Sync (Embedding/Push) |1-5 seconds                        |
|**ASYNCHRONOUS**   |Summary Update (Debounced 60s)|Execution < 2 seconds              |
|**SERVICE LATENCY**|POST `/active-context/request`|**< 2s** (includes Evna enrichment)|

### ‚ñì IMPLEMENTATION PATHS

```
/active-context/
‚îú‚îÄ‚îÄ streams/
‚îÇ   ‚îú‚îÄ‚îÄ {user}-full.log        # RAW CAPTURE (File A)
‚îÇ   ‚îú‚îÄ‚îÄ {user}-compressed.log  # FREAKAST (File B)
‚îÇ   ‚îî‚îÄ‚îÄ {user}-summary.md      # ROLLING SUMMARY
‚îú‚îÄ‚îÄ enriched/
‚îÇ   ‚îî‚îÄ‚îÄ {timestamp}-enriched.json  # EVNA'S ASYNC ADDITIONS
‚îú‚îÄ‚îÄ feeds/
‚îÇ   ‚îî‚îÄ‚îÄ {user}-feed.json       # GENERATED FEED (NO ECHO)
‚îî‚îÄ‚îÄ config/
    ‚îî‚îÄ‚îÄ echo-window.yaml       # EXCLUSION TIMING CONFIG
```

-----

## ‚ñà FREAKAST COMPRESSED REFERENCE ‚ñà

```
üìø::ACTIVECONTEXT.PROTOCOL{
  
  üéµ::dual.op{
    karen@front[ingest,classify,preview,shape]‚Üí
    evna@core[archive,connect,enrich,surface]‚Üí
    handshake::CONTINUOUS
  }

  üê¶::chirp{
    ceremony::LOW
    response::NONE
    purpose::SEED.CONTEXT
    write::[full.log,compressed.log]‚ÜíSYNC
    enrich::ASYNC
  }

  üìã::request{
    ceremony::HIGH
    response::SHAPED
    purpose::HARVEST.CONTEXT
    uses::chirp.stream.as.weight
  }

  üìÅ::dual.write{
    file.A[full.log]‚Üíarchaeology
    file.B[compressed.log]‚Üíretrieval+autorag
    timing::<100ms.SYNC
  }

  üîá::echo.exclusion{
    rule::"own.recent‚ÜíEXCLUDE"
    window::30min.default
    include::[other.agents,system.events,connections]
  }

  ‚àû::loop{
    chirp.chirp.chirp‚Üícontext.accumulates‚Üí
    request‚ÜíSHAPED.by.accumulated.context
  }
}
```

-----

## ‚ñà ARTIFACT PROVENANCE ‚ñà

|LAYER                 |SOURCE         |CONTRIBUTION                                                  |
|:---------------------|:--------------|:-------------------------------------------------------------|
|**Original Concept**  |Evan (human)   |Record shop metaphor, chirp vs request, echo exclusion insight|
|**Prose Scaffold**    |Claude Opus 4.5|Narrative architecture, implementation spec, BBS integration  |
|**Acquisition Matrix**|Gemini 2.5 Pro |Ops tables, timing guarantees, deployment-ready formatting    |

-----

## ‚ñà BBS INTEGRATION ‚ñà

**Suggested Location:** `/projects/common/techcraft/active-context-protocol-ops.md`

**Related Artifacts:**

- `float-dispatch-record-shop-architecture.md` (prose)
- `float-dispatch-record-shop-compressed.freakast` (FreakAST)
- `float-dispatch-active-context-protocol.md` (scaffold)

**Tags:** `[active-context, chirp-pattern, dual-write, feed-design, karen, evna, echo-exclusion, ops-matrix, gemini-mirror]`

**Bridge:** `float/techcraft/active-context-protocol`

-----

```
‚ñà‚ñì‚ñí‚ñë END ACQUISITION MATRIX ‚ñë‚ñí‚ñì‚ñà
GENERATED:: 2025-11-29 @ 17:30
WITNESS:: claude.opus.4.5 + gemini.2.5.pro
MODE:: saturday.putters ‚Üí techcraft.dispatch
STATUS:: DEPLOYMENT.READY
```

üêêüìºüõÅ‚àû